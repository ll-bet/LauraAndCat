<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Laura and Cat</title>

<!-- Welcome to ZIM at http://zimjs.com - Code Interactive Media Pizzazz!           -->
<!-- ZIM runs on the HTML Canvas powered by JavaScript and CreateJS http://createjs.com -->
<!-- Founded by Inventor Dan Zen - http://danzen.com - Canadian New Media Award Winner  -->
<!-- ZIM is free to use. You can donate to help improve ZIM at http://zimjs.com/donate  -->

<script src="js/createjs_1.1_min.js"></script>
<script>
    var zon = true; // set to false to turn off console messages from zim
    var zns = false; // set to true to require zim namespace - eg. new zim.Frame()
</script>
<script src="js/zim_6.9.0.js"></script>
<!-- use zimjs.com/distill for minified individual functions! -->

<style>
    @font-face {
            font-family: 'Gugi';
            src: url(../assets/fonts/Gugi-Regular.ttf) format('truetype');
        }
</style>

<script>

// SCALING OPTIONS
// scaling can have values as follows with full being the default
// "fit"    sets canvas and stage to dimensions and scales to fit inside window size
// "outside"    sets canvas and stage to dimensions and scales to fit outside window size
// "full"   sets stage to window size with no scaling
// "tagID"  add canvas to HTML tag of ID - set to dimensions if provided - no scaling


// as of ZIM 5.5.0 you do not need to put zim before ZIM functions and classes
var frame = new Frame();
frame.on("ready", function() {
    zog("ready from ZIM Frame"); // logs in console (F12 - choose console)

    var stage = frame.stage;
    var stageW = frame.width;
    var stageH = frame.height;

    frame.color = "#ddd";

    var waiter = new Waiter(stage);
waiter.show(); 

  frame.loadAssets(['ball.png','cards.png','cat.png','clock.png','coin.png','cube.png','dice.png','forest.png','girl.png','lizzard.png','main.png','rock.png','sea.png','tree.png','BeepBox-Song.wav','sound.png','mute.png',{font:"Gugi", src:"/fonts/Gugi-Regular.ttf"}], "assets/");
  
frame.on("complete", function(){ 
     waiter.hide();
//~~~ items
start();

function start(){
//PAGE1
var ball=frame.asset('ball.png');
var cube=frame.asset('cube.png');

//PAGE2
var coin=frame.asset('coin.png');
var dice=frame.asset('dice.png');
var clock=frame.asset('clock.png');

//PAGE3
var cards=frame.asset('cards.png'); 
var lizzard=frame.asset('lizzard.png');
var tree=frame.asset('tree.png');


var forest=frame.asset('forest.png');
var bg= frame.asset('main.png');


//~~~~characters
var cat=frame.asset('cat.png');//page1
var girl=frame.asset('girl.png');//page1

//~~ score

var score=0;
var startPan = 0;
var startVolume=.5;
var music =frame.asset("BeepBox-Song.wav").play({loop:-1,pan:startPan,volume:startVolume});
var manager = new LayoutManager();
var responseLabel;
var responseText;
var button;
 var prologueSceen=new Container (stageW, stageH);
var screenCont= new Container();
var introScreen = new Container(stageW,stageH).addTo(stage);

// game();
intro();
// var manager = new LayoutManager();

function intro() { 




bg.center(introScreen);
var title= new Label({
   text:"Laura & Cat",
   size:65,
   font:"Gugi",
   color:"white",
   rollColor:"red"
}).center(introScreen)
.mov(0,-25);



var start_label= new Label({
            text: "start",
            size:25,
            color:"white",
            font:"Gugi",
            fontOptions:"bold"
        });


 var start_btn=new Button({
            label:start_label,
            width:115,
            height:75,
            color:"#FF5733",
            rollColor:"darkorange",
            corner:35
        })
    .center(introScreen)
    .mov(0,100);


 var layoutIntro= new Layout(stage,
            [
                {object:introScreen},
            ], null,null, false, new Shape(), stage
        );
 layoutIntro.dispose();
 start_btn.on("click", function(e){
            title.removeFrom(introScreen);
            start_btn.removeFrom(introScreen);
            stage.update();
            // game();
           instr();
        });

}// end of intro()

function instr(){
    console.log("hit")
    var instructions = new Label({
           text:"Help Laura escape the\n mystical land by solving all of\n the cat's riddles.",
           size:23,
           color:"white",
           align:"center",
            font:"courier",
           lineHeight:30,
           backgroundColor:"#628b9f",
           backgroundBorderColor:"#19455a",
            backgroundBorderWidth:10, 
            backgroundCorner:20,
            padding:15
        }).center(introScreen).mov(0,-50);

 var nextLabel= new Label({
   text:"next",
   font:"courier",
   size:25,
   color:"white",
   fontOptions:"bold"
});

    var next=new Button({
            label:nextLabel,
            width:115,
            height:75,
            color:"#FF5733",
            rollColor:"darkorange",
            corner:35
        })
    .center(introScreen)
    .mov(0,100);

    next.on("click", function(e){
            introScreen.removeFrom(stage);
            stage.update();
            game();
        });


stage.update();
}// end of instructions()


 //game();
function game() {

//~~~~~Page1
        var page1= new Container().addTo(stage);

        var contentPage1= new Container(stageW,stageH).addTo(page1);
      // ball.outline();

    //BACKGROUND
        var bg_game= frame.asset('main.png').center(contentPage1);
    //END OF BACKGROUND 
    
    //PAGE ITEMS CONTAINER
        var page1Items=new Container().addTo(page1).drag();  

    //END OF PAGE ITEMS CONTAINER

    //PAGE ITEMS
        var rock= frame.asset('rock.png').center(contentPage1).sca(0.5).pos(610, 317);

       
        

        //var circle= new Circle(50, "red").addTo(page1Items).pos(330, 300);
      var catContainer=new Container().addTo(page1);
       cat.addTo(catContainer).sca(0.5).pos(900, 200).expand(); 
      // cat.outline();
        //var rectHit=new Rectangle(50,50, "blue").addTo(page1Items).pos(200, 500).noDrag();

    girl.addTo(contentPage1).sca(0.3).pos(200, 300);

    

//~~~Page 2
    //PAGE CONTAINER  

        var page2= new Container().addTo(stage);
      
    // END OF PAGE CONTAINER 

    //BACKGROUND
        var bg_sea= frame.asset('sea.png').center(page2);
    //END OF BACKGROUND

    //PAGE ITEMS CONTAINER
        var page2Items=new Container().addTo(page2).drag();
    //END OF PAGE ITEMS CONTAINER

    //ITEMS PAGE 2
 ball.addTo(page2Items).sca(0.3).pos(750, 426);
    coin.addTo(page2Items).sca(0.3).pos(300, 326);
    dice.addTo(page2Items).sca(0.3).pos(140, 476);
    clock.addTo(page2Items).sca(0.3).pos(520, 125);

    //END OF ITEMS

//~~~~Page 3

        var page3= new Container().addTo(stage);
    //BACKGROUND
        var bg_forest= frame.asset('forest.png').center(page3);
    // END OF BACKGROUND 

    //PAGE 3 ITEMS CONTAINER

    //PAGE ITEMS CONTAINER
        var page3Items=new Container().addTo(page3).drag();
    //END OF PAGE 3 ITEMS CONTAINER

    //ITEMS PAGE 3
        cards.addTo(page3Items).sca(0.3).pos(556, 239);
        lizzard.addTo(page3Items).sca(0.3).pos(140, 376);
        tree.addTo(page3Items).sca(0.3).pos(265, 223);
        cube.addTo(page3Items).sca(0.3).pos(600, 95);


    //END OF ITEMS

//~~~Pages together
        var pages= new Pages({
           pages:[
            // imagine pages to the left, right, up and down
      // swipe:["to page on left", "to page on right", etc.s]
                {page:page1, swipe:[page3,page2,null,null]},
                {page:page2, swipe:[page1,null,null,null]},
                {page:page3, swipe:[null,page1,null,null]}
            ], transition:"slide",speed:500

        }); //this is a class
        stage.addChild(pages);

//~~~~Stage objects

    var stageCont=new Container(stageW, stageH).center(stage);
        button = new Button({
                label:"",
                width:100,
                height:100,
                toggle:frame.asset('sound.png'),
                backing:frame.asset('mute.png')
            })
                .sca(0.3);
            button
                .addTo(stage)
                .pos(2,2);
            button.on("click", function(){
                music.muted=button.toggled;
            }); // end of button

        var contW=300;
        var contH=90;

        var objContainer= new Container(contW,contH).center(stageCont);
        // var objContainer= new Container(500,500).centerReg(stage).outline();

        // var objHolder= new Rectangle({
        //         width:250,
        //         height:80, 
        //         color:"#C26561", 
        //         corner:20})
        //     .center(objContainer)
        //     .mov(0,130)
        //    .center(objContainer)
        //    .outline();

        var itemHold1= new Rectangle({
                width:70,
                height:70, 
                color:"#F5DAD9",
                borderColor:"black",
                borderWidth:5, 
                corner:10})
            .center(objContainer)
            .mov(0,0);

        var itemHold2=itemHold1.clone()
            .center(objContainer)
            .mov(90,0);

         var itemHold3=itemHold1.clone()
            .center(objContainer)
            .mov(-90,0);
// END OF STAGE OBJECTS

//item check
var catAnswerCont= new Container();

     var catAnswer= 
    new Label({
           text:"This is a correct item",
           size:23,
           color:"black",
           align:"center",
           lineHeight:30,
           backgroundColor:"#cccccc",
           backgroundBorderColor:"#19455a",
            backgroundBorderWidth:10, 
            backgroundCorner:20,
            padding:15
        });
    var catAhold= new Button({
            label:"x",
           width:50,
           height:50,
           color:"purple",
           rollColor:"MediumOrchid",
           corner:25
            }).center(catAnswerCont).mov(catAnswer.width/2+25,0);
   
   catAhold.on("click",function() {
        catAnswerCont.removeFrom(stage);
        //coin.removeFrom(page1Items);
       score++;
       if (score==3){
            console.log("done");
            done();
       }
        
        stage.update();
    });




//end of item check

function done(){
console.log("im done");
    rectW=400;
    rectH=200;
    var containerEnd = new Container(rectW, rectH).center(stage);
     containerEnd.x=-rectW;
    containerEnd.y=300;

    var endLabel = new Label({
                    text:"Laura is free!",
                    size:50,
                    color:"black",
                    backgroundColor:"#628b9f",
                    backgroundBorderColor:"#19455a",
                    backgroundBorderWidth:10, 
                    backgroundCorner:20,
                    font:"Gugi",
                    align:"center"
                }).center(containerEnd).mov(0,-40);


     var exitLabel= new Label({
   text:"restart",
   font:"courier",
   size:25,
   color:"white",
   fontOptions:"bold"
});

    var exitButton = new Button({ 
                        label:exitLabel,
                        width:150,
                        height:75,
                        color:"#FF5733",
                        corner:25
                      });

var buttonHold=new Container(button.width, button.height)
                  .center(containerEnd)
                  .mov(0,40);
        exitButton.center(buttonHold);
                containerEnd.animate(
                    {obj:{x:containerEnd.x+stage.width/2+containerEnd.width/2},
                    time:1000,
                    ease:"backOut"
                });

                buttonHold.on("click", function(e){
                 
                  // containerEnd.removeAllChildren();
                  // page1.removeAllChildren();
                  // page2.removeAllChildren();
                  // page3.removeAllChildren();
                  music.volume=startVolume;
                  //startPan=0;
                  music.pan = startPan;
                  stage.removeAllChildren();
                  stage.update();
                   start();
                  
                });
                stage.update();

}//end of done





    //GRABBING AND DROPPING ITEMS
        page1Items.on("pressmove", function(e) {
           if (e.target.parent!=stageCont &&  e.target.hitTestBounds(objContainer) ) {
                console.log("hit");
                e.target.addTo(stageCont);
                e.target.mov(0,10);
               // e.target.drag();
               
                 stage.update();
            }

            if (coin.hitTestBounds(catContainer) ) {
                console.log("correct object");
                coin.removeFrom(page1Items);
                catAnswer.addTo(catAnswerCont);
                catAnswerCont.center(stage);
                stage.update();
            }// end of if

            if (cards.hitTestBounds(catContainer) ) {
                console.log("correct object");
                cards.removeFrom(page1Items);
                catAnswer.addTo(catAnswerCont);
                catAnswerCont.center(stage);
                stage.update();
            }// end of if

             if (clock.hitTestBounds(catContainer)) {
                console.log("correct object");
                clock.removeFrom(page1Items);
                catAnswer.addTo(catAnswerCont);
                catAnswerCont.center(stage);
                stage.update();
            }// end of if

           
        });// works?

         page2Items.on("pressmove", function(e) {
           if (e.target.parent!=stageCont &&e.target.hitTestBounds(objContainer) ) {
                console.log("hit");
                e.target.addTo(stageCont);
                  e.target.mov(0,10);
                e.target.drag();
                //e.target.parent.mov(10,10);
                 stage.update();
            }
           
        });// works?

          page3Items.on("pressmove", function(e) {
           if (e.target.parent!=stageCont && e.target.hitTestBounds(objContainer)) {
                console.log("hit");
                e.target.addTo(stageCont);
                  e.target.mov(0,10);
               e.target.drag();
                //e.target.parent.mov(10,10);
                stage.update();
            }
            
        });// works?

        stageCont.on("pressmove", function(e){
            if(e.target.parent==stageCont && !e.target.hitTestBounds(objContainer)) {
                 e.target.addTo(pages.page);
                 if(pages.page==page1){
                    e.target.addTo(page1Items);
                    console.log("im on the main page");
                 } else if(pages.page==page2){
                    e.target.addTo(page2Items);
                     console.log("im on page 2");
                 } else if (pages.page==page3){
                    e.target.addTo(page3Items);
                    console.log("im on page 3");
                 }// end of page check
            }//end of hit test
             stage.update();
        });
    // END OF GRABBING AND DROPPING ITEMS
    
    //ANSWER CHECK
    // coin.on("pressmove", function() {
    //     if (coin.hitTestBounds(cat)) {
    //         console.log("correct object");
    //         catAnswer.addTo(catAnswerCont);
    //         catAnswerCont.center(stage);
    //         stage.update();

    //     }// end of if
    // });
    //END OF ANSWER CHECK


//CATS RIDDLES

var questions=['1. I have a tail, and I have a head, but I have no body. I am NOT a snake. What am I?', '2. What has hands but can not clap?','3. What has 13 hearts, but no other organs?'];

//var riddles;

    cat.on("click",function(e) {
       riddlePrint();
    });
var titles = new Container()
        .addTo(contentPage1)
        .pos(400, 150);

    var riddles;     
function riddlePrint(){
    //shuffle(questions);
   
        loop(questions, function(riddle, i) {
            // 4. make ZIM Label with following parameters (more options in doc)
            // labelText, fontSize, font, textColor, textRollColor, shadowColor
            riddles = new Label({
                text:riddle,
                size:20,
                font:"Courier",
                 color:"#660066",
                 lineWidth:700,
                  fontOptions:"bold"
            })
                .addTo(titles)
                .pos(null, i * 50)
            riddles.startX = riddles.x; // for snapping
            riddles.startY = riddles.y;
        });

}//end of riddle print

// END OF RIDDLES


    //  GAME CHECK
    if(score==1){
        console.log("Laura is free");
    }

    // GAME END
//~~~ Layout
//(holder, regions, lastMargin, backgroundColor, vertical, regionShape, scalingObject, hideKey)

          var layoutStage= new Layout(stage,
            [
                {object:button, width:3, valign:"top"},
                {object:objContainer, marginLeft:33, width:30, align:"center",valign:"bottom"}
                //{object:rectTest, marginLeft:0, width:30, align:"center",valign:"bottom"}
            ], 33,null, false, new Shape(), stage
        ); // for button & container

          layoutStage.dispose();
         //layout.dispose();
        // manager.add(layout);
        manager.add(layoutStage);
        // manager.add(layoutIntro);




        frame.on("resize", function() {
           manager.resize();
           pages.resize();
           stage.update();
          // introScreen.resize();
        });




stage.update(); //of game
    }// end of game()


// manager.add(introScreen);
// frame.on("resize", function() {
//            manager.resize();
//            stage.update();
//           // introScreen.resize();
//         });


}// end of start
    stage.update(); //of frame complete
});// end of frame complete

    stage.update(); // this is needed to show any changes

}); // end of ready


</script>

<meta name="viewport" content="width=device-width, user-scalable=no" />

</head>

<body>
<!-- canvas with id="myCanvas" is made by zim Frame -->
</body>
</html>